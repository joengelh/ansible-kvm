---
- name: create directory for the repositories
  file:
    path: "{{ item }}"
    state: directory
    recurse: yes
  loop:
  - /localrepo/

- name: find all .tar.gz files to be unpacked
  find:
    paths: /var/packages/
    patterns: '*.tar.gz'
  register: gzFiles

- name: unpack rpm files to directory
  unarchive:
    copy: yes
    src: "/localrepo/"
    src: "{{ item }}"
    dest: /localrepo
  loop: 
  - gzFiles
  register: copyResult 

- name: copy license folder to directory
  copy:
    src: "{{ item }}"
    dest: /localrepo/licenses/
  loop:
  - /var/licenses/
