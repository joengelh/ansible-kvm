---
- name: install required packages
  yum:
    name: 
    - createrepo
    - httpd
    state: latest

- name: create directory for the repositories
  file:
    path: /localrepo
    state: directory

- name: copy files to directory
  copy:
    src: "{{ item }}"
    dest: /localrepo
  loop: 
  - /var/packages/
  - /var/licenses/
  register: copyresult

- name: run createrepo
  command: "createrepo /localrepo"
  when: copyresult.changed
